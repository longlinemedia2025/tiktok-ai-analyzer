<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TikTok, YouTube & Instagram Viral Optimizer</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body class="tiktok-theme">
  <div class="container">
    <img src="{{ url_for('static', filename='Longlinemedialogotransparent.png') }}" alt="LongLine Media Logo" class="logo">

    <h1>ğŸ¬ Viral Video Optimizer</h1>

    <!-- Platform Selector -->
    <div class="platform-switch">
      <label for="platform">Select Platform:</label><br />
      <select id="platform">
        <option value="TikTok">TikTok</option>
        <option value="YouTube">YouTube</option>
        <option value="Instagram">Instagram</option>
      </select>
    </div>

    <!-- Upload Section -->
    <div id="upload-form">
      <p>ğŸ¥ Drag and drop your video here or click below:</p>
      <input type="file" id="video" accept="video/*" hidden />
      <label for="video">
        <button id="upload-btn">Choose Video</button>
      </label>
      <p id="upload-status"></p>
    </div>

    <!-- Glow Bar -->
    <div id="glow-bar"></div>

    <!-- Analyze Button -->
    <button id="analyze-btn">Analyze</button>

    <!-- Loading Section -->
    <div class="loading-section hidden" id="loading-section">
      <div class="loading-bar"></div>
      <p id="loading-text">Initializing AI analysis...</p>
    </div>

    <!-- Results -->
    <div id="result-card" class="hidden">
      <pre id="results"></pre>
    </div>
  </div>

  <script>
    const platformSelect = document.getElementById("platform");
    const glowBar = document.getElementById("glow-bar");
    const loadingSection = document.getElementById("loading-section");
    const loadingText = document.getElementById("loading-text");
    const analyzeBtn = document.getElementById("analyze-btn");
    const resultCard = document.getElementById("result-card");
    const resultsPre = document.getElementById("results");
    const uploadStatus = document.getElementById("upload-status");
    const videoInput = document.getElementById("video");

    let currentPlatform = "TikTok";
    let loadingInterval;

    // Platform Theme Switch
    platformSelect.addEventListener("change", () => {
      document.body.classList.remove("tiktok-theme", "youtube-theme", "instagram-theme");
      currentPlatform = platformSelect.value;
      if (currentPlatform === "TikTok") document.body.classList.add("tiktok-theme");
      if (currentPlatform === "YouTube") document.body.classList.add("youtube-theme");
      if (currentPlatform === "Instagram") document.body.classList.add("instagram-theme");
    });

    // File Upload Display
    videoInput.addEventListener("change", () => {
      const file = videoInput.files[0];
      if (file) {
        uploadStatus.textContent = `ğŸ¬ Uploaded: ${file.name}`;
      }
    });

    // Analyze Button Click
    analyzeBtn.addEventListener("click", async () => {
      const file = videoInput.files[0];
      if (!file) {
        uploadStatus.textContent = "âš ï¸ Please upload a video first.";
        return;
      }

      // Start loading visuals
      glowBar.classList.add("active");
      loadingSection.classList.remove("hidden");
      analyzeBtn.disabled = true;
      uploadStatus.textContent = "";
      resultCard.classList.add("hidden");

      // Animate loading text
      const loadingPhrases = {
        TikTok: [
          "Analyzing TikTok engagement metrics...",
          "Detecting trending sounds and formats...",
          "Evaluating hook strength...",
          "Generating viral caption ideas..."
        ],
        YouTube: [
          "Scanning YouTube retention patterns...",
          "Evaluating thumbnail contrast...",
          "Detecting keyword alignment...",
          "Generating SEO-friendly title suggestions..."
        ],
        Instagram: [
          "Analyzing Instagram Reels performance...",
          "Evaluating visual storytelling style...",
          "Checking niche consistency and aesthetics...",
          "Generating caption and hashtag strategy..."
        ]
      };

      let idx = 0;
      clearInterval(loadingInterval);
      loadingInterval = setInterval(() => {
        loadingText.textContent = loadingPhrases[currentPlatform][idx];
        idx = (idx + 1) % loadingPhrases[currentPlatform].length;
      }, 2500);

      // Simulate AI API request delay (replace with actual fetch call)
      await new Promise(res => setTimeout(res, 7000));

      // Stop loading visuals
      clearInterval(loadingInterval);
      glowBar.classList.remove("active");
      loadingSection.classList.add("hidden");
      analyzeBtn.disabled = false;
      resultCard.classList.remove("hidden");

      // Generate mock output with your structure
      const videoName = file.name;
      const mockData = {
        duration: 42,
        resolution: "1080x1920",
        aspect_ratio: "9:16",
        brightness: "High",
        tone: "Energetic",
        niche: "Personal Branding",
        keywords: "Motivation, Growth, CreatorMindset"
      };

      const insightsLabel =
        currentPlatform === "YouTube" ? "YouTube Insights"
        : currentPlatform === "Instagram" ? "Instagram Insights"
        : "TikTok Insights";

      const tagLabel =
        currentPlatform === "YouTube" ? "tags"
        : currentPlatform === "Instagram" ? "hashtags"
        : "hashtags";

      const platformOutput = `
Create a viral video analysis for ${currentPlatform} with this structure EXACTLY:

ğŸ¬ Drag and drop your ${currentPlatform} video file here: "${videoName}"
ğŸ¥ Running ${currentPlatform} Viral Optimizer...

ğŸ¤– Generating AI-powered analysis, captions, and viral tips...

ğŸ”¥ Fetching viral video comparisons and strategic insights...

âœ… ${currentPlatform} Video Analysis Complete!

ğŸ¬ Video: ${videoName}
ğŸ“ Duration: ${mockData.duration}s
ğŸ–¼ Resolution: ${mockData.resolution}
ğŸ“± Aspect Ratio: ${mockData.aspect_ratio}
ğŸ’¡ Brightness: ${mockData.brightness}
ğŸ¨ Tone: ${mockData.tone}
â­ Heuristic Score: 8/10 (High brightness and clear resolution contribute to visual appeal.)

ğŸ¯ Detected Attributes:
- Niche: ${mockData.niche}
- Tone: ${mockData.tone}
- Keywords: ${mockData.keywords}

ğŸ’¬ ${insightsLabel}:
### 1. Scroll-Stopping Caption
(One creative, high-performing caption idea â€” ${
        currentPlatform === "Instagram"
          ? "emotional, story-driven, and includes a subtle CTA to save/share."
          : "platform-optimized for engagement."
      })

### 2. 5 Viral ${tagLabel}
(Provide 5 ${currentPlatform}-relevant ${tagLabel} that match the ${currentPlatform} algorithm.)

### 3. Actionable Improvement Tip for Engagement
(Platform-specific engagement improvement advice.)

### 4. Viral Optimization Score (1â€“100)
(Score with explanation tailored to ${currentPlatform}'s algorithm.)

### 5. Motivation to Increase Virality
(Encouraging, ${currentPlatform}-specific creator tip.)

ğŸ”¥ Viral Comparison Results:
### Comparison with Viral ${currentPlatform} Videos in the Same Niche
#### Viral Example 1
- **Video Concept Summary:** ...
- **What Made It Go Viral:** ...
- **How to Replicate Success:** ...

#### Viral Example 2
- **Video Concept Summary:** ...
- **What Made It Go Viral:** ...
- **How to Replicate Success:** ...

#### Viral Example 3
- **Video Concept Summary:** ...
- **What Made It Go Viral:** ...
- **How to Replicate Success:** ...

### Takeaway Strategy
(Summarize actionable insights for ${currentPlatform} creators.)

ğŸ“‹ Actionable Checklist:
- Hook viewers in the first 2 seconds.
- Use trending audio and relevant captions.
- Encourage saves and shares with call-to-actions.
- Post during peak activity windows (Friâ€“Sun, 6â€“10pm).
- Maintain visual consistency across Reels.

ğŸ¯ **Detected Niche:** ${mockData.niche}
ğŸ•“ **Best Time to Post for ${mockData.niche} (${currentPlatform})**:
â° 4â€“7 PM EST
ğŸ’¡ Peak engagement around 8:43 PM EST.
`;

      resultsPre.textContent = platformOutput;
    });
  </script>
</body>
</html>
